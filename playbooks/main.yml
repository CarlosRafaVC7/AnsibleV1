---
# Playbook principal: Administraci√≥n total de laboratorios
# SO-Ansible (ESXi Lab) - Soporte para Linux Mint y Windows 10

- name: Configuraci√≥n de seguridad integral ESXi Lab
  hosts: managed
  become: yes
  ignore_unreachable: yes
  roles:
    - security

- name: Administraci√≥n completa en Laboratorio Acad√©mico (Linux Mint ESXi)
  hosts: academico
  become: yes
  ignore_unreachable: yes
  roles:
    - linux_users
    - linux_storage
    - linux_services
    - linux_jobs

- name: Administraci√≥n completa en Laboratorio Gamer (Windows 10 ESXi)
  hosts: gamer
  ignore_unreachable: yes
  roles:
    - windows_users
    - windows_storage
    - windows_services
    - windows_jobs

- name: Resumen de administraci√≥n
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Mostrar resumen final
      ansible.builtin.debug:
        msg:
          - "=== LABORATORIO ESXi ADMINISTRADO COMPLETAMENTE ==="
          - ""
          - "üîí Seguridad configurada en todos los hosts"
          - "üñ•Ô∏è Hosts configurados:"
          - "  Acad√©mico (Linux Mint): {{ groups['academico'] | length }} host(s)"
          - "  Gamer (Windows 10): {{ groups['gamer'] | length }} host(s)"
          - "  ESXi Total: {{ groups['esxi'] | length }} host(s)"
          - ""
          - "üõ°Ô∏è  Pol√≠ticas de seguridad aplicadas:"
          - "  - Firewall configurado (iptables/Windows Firewall)"
          - "  - SSH/RDP hardening aplicado"
          - "  - Monitoreo de seguridad activo"
          - "  - Integraci√≥n con pol√≠ticas ESXi"
          - ""
          - "Siguiente paso: ansible-playbook tests/validate_configuration.yml"