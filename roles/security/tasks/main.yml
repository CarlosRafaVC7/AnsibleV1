---
# Rol principal de Seguridad Integral
# Configura iptables, firewall, polÃ­ticas ESXi y seguridad local

- name: Mostrar inicio de configuraciÃ³n de seguridad
  ansible.builtin.debug:
    msg:
      - "ğŸ”’ INICIANDO CONFIGURACIÃ“N DE SEGURIDAD INTEGRAL"
      - "ğŸ–¥ï¸  Host: {{ inventory_hostname }}"
      - "ğŸŒ IP: {{ ansible_default_ipv4.address | default('N/A') }}"
      - "ğŸ§ OS: {{ ansible_distribution }} {{ ansible_distribution_version }}"

# Tareas especÃ­ficas por sistema operativo
- name: Incluir tareas Linux/Ubuntu
  include_tasks: linux_security.yml
  when: ansible_os_family == "Debian"

- name: Incluir tareas Windows
  include_tasks: windows_security.yml
  when: ansible_os_family == "Windows"

- name: Incluir tareas macOS
  include_tasks: macos_security.yml
  when: ansible_os_family == "Darwin"

# ConfiguraciÃ³n comÃºn de red y conectividad
- name: Incluir configuraciÃ³n de red segura
  include_tasks: network_security.yml

# PolÃ­ticas de seguridad avanzada
- name: Incluir polÃ­ticas avanzadas
  include_tasks: advanced_policies.yml

# Monitoreo y logging de seguridad
- name: Incluir monitoreo de seguridad
  include_tasks: security_monitoring.yml

- name: Mostrar resumen de seguridad configurada
  ansible.builtin.debug:
    msg:
      - "âœ… CONFIGURACIÃ“N DE SEGURIDAD COMPLETADA"
      - "ğŸ”’ Firewall configurado y activo"
      - "ğŸŒ PolÃ­ticas de red aplicadas"
      - "ğŸ“Š Monitoreo de seguridad habilitado"
      - "ğŸ›¡ï¸  Sistema protegido segÃºn polÃ­ticas ESXi"